# نظام إدارة المخزون

نظام إدارة مخزون يدوي مبني باستخدام Laravel مع نظام تسجيل دخول للمدير فقط.

## المميزات

- ✅ نظام تسجيل دخول للمدير فقط
- ✅ إدارة المنتجات (إضافة، تعديل، حذف)
- ✅ تسجيل المشتريات
- ✅ تسجيل المبيعات
- ✅ مرتجع البيع والشراء
- ✅ تسجيل التلف
- ✅ تعديل الجرد
- ✅ حساب متوسط التكلفة (Average Cost)
- ✅ تقارير شاملة (المخزون، الأرباح، المبيعات، مخزون منخفض)

## التثبيت

1. قم بتشغيل الـ migrations:
```bash
php artisan migrate
```

2. قم بتشغيل الـ seeder لإنشاء حساب Admin:
```bash
php artisan db:seed --class=AdminSeeder
```

3. بيانات تسجيل الدخول الافتراضية:
- **البريد الإلكتروني:** admin@example.com
- **كلمة المرور:** password

## البنية

### الجداول
- `products` - المنتجات
- `purchases` - المشتريات
- `sales` - المبيعات
- `stock_movements` - حركات المخزون

### Models
- `Product` - نموذج المنتج
- `Purchase` - نموذج الشراء
- `Sale` - نموذج البيع
- `StockMovement` - نموذج حركة المخزون

### Services
- `StockService` - خدمة إدارة المخزون وحساب Average Cost

### Controllers
- `Auth/LoginController` - تسجيل الدخول والخروج
- `DashboardController` - لوحة التحكم
- `ProductController` - إدارة المنتجات
- `PurchaseController` - إدارة المشتريات
- `SaleController` - إدارة المبيعات
- `StockMovementController` - إدارة حركات المخزون
- `ReportController` - التقارير

## كيفية الاستخدام

### 1. إضافة منتج
- انتقل إلى "المنتجات" → "إضافة منتج"
- أدخل اسم المنتج، SKU، وسعر البيع

### 2. تسجيل شراء
- انتقل إلى "المشتريات" → "تسجيل شراء"
- اختر المنتج وأدخل الكمية وسعر التكلفة
- سيتم حساب متوسط التكلفة تلقائياً

### 3. تسجيل بيع
- انتقل إلى "المبيعات" → "تسجيل بيع"
- اختر المنتج وأدخل الكمية وسعر البيع
- سيتم حساب الربح تلقائياً بناءً على متوسط التكلفة

### 4. مرتجع البيع
- انتقل إلى "مرتجع بيع"
- اختر البيع المراد إرجاعه وأدخل الكمية
- سيتم إرجاع الربح تلقائياً

### 5. مرتجع الشراء
- انتقل إلى "مرتجع شراء"
- اختر الشراء المراد إرجاعه وأدخل الكمية

### 6. تسجيل تلف
- انتقل إلى "تلف"
- اختر المنتج وأدخل الكمية التالفة

### 7. تعديل الجرد
- انتقل إلى "تعديل جرد"
- اختر المنتج وأدخل الكمية (موجب للإضافة، سالب للطرح)

## حساب Average Cost

يتم حساب متوسط التكلفة تلقائياً عند كل شراء جديد:

```
متوسط التكلفة = (إجمالي قيمة المخزون الحالي + قيمة الشراء الجديد) / إجمالي الكمية الجديدة
```

## التقارير

- **تقرير المخزون:** يعرض جميع المنتجات مع المخزون الحالي ومتوسط التكلفة
- **تقرير الأرباح:** يعرض الأرباح خلال فترة زمنية
- **تقرير المبيعات:** يعرض جميع المبيعات خلال فترة زمنية
- **مخزون منخفض:** يعرض المنتجات التي يقل مخزونها عن 10 وحدات

## ملاحظات مهمة

- المخزون يُحسب فقط من مجموع حركات المخزون
- لا يمكن تعديل الكمية مباشرة في جدول المنتجات
- جميع العمليات تسجل كحركات مخزون
- الربح يُحسب تلقائياً عند كل بيع

## الأمان

- جميع المسارات محمية بـ `auth` middleware
- لا يوجد تسجيل مستخدمين من الواجهة
- يوجد حساب Admin واحد فقط

